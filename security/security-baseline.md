# 安全配置基线 - Digital Bank POC

**版本**: v1.0.0  
**发布日期**: 2026-01-27  
**维护者**: Agent 7 (安全扫描卫士)  
**依据**: 技术标准规范 v1.0、命名规范 v1.0、OWASP Top 10、CWE Top 25

---

## 1. 概述

本文档定义数字银行 POC 的安全配置基线，供开发、基础设施与运维在编码、部署与运营中强制执行。**零高危漏洞容忍**，中危漏洞及时修复。

---

## 2. 认证与授权

| 配置项 | 基线要求 | 说明 |
|--------|----------|------|
| 认证方式 | JWT Token | 技术标准 v1.0 |
| Access Token 过期 | 1 小时 | 可调，需文档化 |
| Refresh Token 过期 | 7 天 | |
| 密码策略 | 至少 8 位，含大小写、数字、特殊字符 | 禁止弱口令、常见词典 |
| 失败锁定 | 5 次失败锁定 15 分钟 | 可配置，需审计日志 |
| MFA | 生产环境敏感操作强制 MFA | 可选：TOTP / 短信 / 邮件 |

---

## 3. 数据安全

| 配置项 | 基线要求 | 说明 |
|--------|----------|------|
| 敏感数据加密 | AES-256 | 静态存储（字段/文件级） |
| 密钥管理 | HashiCorp Vault | 禁止硬编码、环境变量明文密钥；见 `vault-config.hcl` |
| 传输加密 | 全链路 HTTPS / TLS 1.2+ | 禁用 SSLv3、TLS 1.0/1.1 |
| 证书 | 有效 CA 签发，禁止自签名入生产 | 到期前 30 天更新 |
| 脱敏 | 日志、错误信息、调试输出禁止明文敏感数据 | 卡号、身份证、手机等按规范脱敏 |

---

## 4. 代码与依赖安全

| 配置项 | 基线要求 | 说明 |
|--------|----------|------|
| SAST | SonarQube，每次提交 | 见 `sonar-project.properties` |
| DAST | OWASP ZAP，每 12 小时 | 见 `owasp-zap-config.json` |
| 依赖扫描 | Snyk / Dependabot / GitLab Dependency Scanning，每日 | 见 `dependency-scan-config.yaml`、`.snyk` |
| 高危漏洞 | 阻塞合并/部署 | 零容忍 |
| 中危漏洞 | 7 天内修复或书面例外 | |
| 已知漏洞组件 | 定期升级，优先补丁 | OWASP A09 |

---

## 5. API 安全

| 配置项 | 基线要求 | 说明 |
|--------|----------|------|
| 路径规范 | `/api/v1/{resource}`，kebab-case | 命名规范 v1.0 |
| 鉴权 | 所有业务 API 需认证，敏感操作需授权 | RBAC / 资源级鉴权 |
| 限流 | 全局限流、单用户限流 | 技术标准：全局限流 1000 req/s，单用户 10 req/s |
| 输入校验 | 必填、类型、长度、格式、业务规则 | 防注入、XSS、XXE |
| 输出 | 统一 JSON，错误信息不泄露内部细节 | |
| CORS | 白名单来源，禁止 `*` | 按环境配置 |

---

## 6. 基础设施与运行时

| 配置项 | 基线要求 | 说明 |
|--------|----------|------|
| 容器镜像 | 非 root 用户、只读根文件系统（可行时）、无不必要的 capabilities | |
| 镜像扫描 | Trivy / Snyk Container，CI 中执行 | 高危阻断 |
| 网络 | 最小权限，按 K8s NetworkPolicy 限制 Pod 间访问 | |
| 秘钥挂载 | 通过 Vault / K8s Secret，不以环境变量明文传递 | |
| 健康检查 | liveness / readiness，禁止在探针中暴露敏感路径 | |
| 默认账户 | 禁用默认/示例账户，修改默认密码 | OWASP A06 |

---

## 7. 日志与审计

| 配置项 | 基线要求 | 说明 |
|--------|----------|------|
| 格式 | 结构化 JSON，含 timestamp、level、service、traceId、message、context | 技术标准 v1.0 |
| 敏感信息 | 禁止记录密码、Token、完整卡号、身份证号等 | 脱敏规则见 Agent 7 SKILL |
| 审计日志 | 登录、鉴权失败、权限变更、关键业务写操作、管理操作 | 不可篡改、可追溯 |
| 保留期 | 审计日志 ≥ 1 年，调试日志按策略归档或删除 | 符合合规 |

---

## 8. 配置与运维

| 配置项 | 基线要求 | 说明 |
|--------|----------|------|
| 调试/诊断 | 生产关闭详细错误栈、调试端点、Swagger/Actuator 等 | 或通过网关/白名单限制 |
| 默认关闭 | 仅开启业务必需的服务与端口 | |
| 依赖服务 | 使用受信镜像与版本，定期更新 | |
| 备份与恢复 | 按《备份和恢复规范》执行，定期演练 | |
| 安全事件 | 按《安全事件响应流程》分级与响应 | P0–P3，见 Agent 7 SKILL |

---

## 9. OWASP Top 10 对照

| 风险 | 防护措施 | 本基线章节 |
|------|----------|------------|
| A01 注入 | 参数化查询、ORM、输入校验、最小权限 | 4, 5 |
| A02 认证失败 | 强密码、MFA、JWT 过期、锁定、HTTPS | 2, 3 |
| A03 敏感数据泄露 | 加密、脱敏、Vault、HTTPS | 3, 7 |
| A04 XXE | 禁用外部实体、安全解析器、输入校验 | 5 |
| A05 访问控制 | RBAC、资源鉴权、默认拒绝 | 2, 5 |
| A06 安全配置错误 | 基线检查、关闭默认账户、移除示例 | 6, 8 |
| A07 XSS | 输出编码、CSP、避免 `innerHTML` 用户输入 | 5 |
| A08 反序列化 | 白名单、避免不安全反序列化 | 4, 5 |
| A09 已知漏洞组件 | 依赖扫描、升级、补丁 | 4 |
| A10 日志与监控 | 日志过滤、监控、告警 | 7, 8 |

---

## 10. 合规检查清单（金融相关）

| 检查项 | 要求 | 状态 |
|--------|------|------|
| 数据加密 | 敏感数据 AES-256 | ✅ 基线要求 |
| 传输加密 | 全链路 HTTPS/TLS 1.2+ | ✅ 基线要求 |
| 身份认证 | 强密码 + 会话管理 | ✅ 基线要求 |
| 访问控制 | 最小权限 | ✅ 基线要求 |
| 审计日志 | 关键操作可追溯 | ✅ 基线要求 |
| 密钥管理 | Vault | ✅ 基线要求 |
| 漏洞管理 | 定期扫描 + 及时修复 | ✅ 基线要求 |

---

## 11. 相关文件

- `sonar-project.properties` — SonarQube 项目配置  
- `owasp-zap-config.json` — OWASP ZAP 扫描配置  
- `vault-config.hcl` — Vault 服务与路径设计  
- `dependency-scan-config.yaml` — 依赖漏洞扫描配置说明  
- `.snyk` — Snyk 策略（项目根目录）  
- `docs/architecture/technical-standards-v1.0.md`  
- `docs/architecture/naming-conventions.md`  
- `skills/agent-7-security/SKILL.md`

---

**生效日期**: 2026-01-27  
**审查周期**: 随技术标准规范或重大架构变更同步修订
